<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>Generate API Key</title>
 <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

 <style>
  body {
background-color: #0d1a26;
 color: #c0c0c0;
}
    
  .card {
   background-color: #1c2e40;
   border: 1px solid #36454f;
   border-radius: 8px;
   box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
  }
    
  .card-header {
   background-color: #36454f;
   color: #ffbf00;
   border-radius: 8px 8px 0 0;
   font-weight: 700;
   border-bottom: 2px solid #ffbf00;
  }
    
  .form-label {
   color: #ffbf00;
   font-weight: 600;
  }
    
  .form-control {
   background-color: #0d1a26;
   border: 1px solid #36454f;
   color: #ffffff;
  }
    
  .form-control:focus {
   background-color: #1c2e40;
   border-color: #ffbf00;
   box-shadow: 0 0 8px rgba(255, 191, 0, 0.4);
  }
    
  .btn-primary {
   background-color: #ffbf00;
   border-color: #ffbf00;
   color: #000000;
   font-weight: 700;
   text-transform: uppercase;
  }
    
  .btn-primary:hover {
   background-color: #e6a700;
   border-color: #e6a700;
   transform: translateY(-1px);
  }
    
  .btn-secondary {
   background-color: #36454f;
   color: #ffffff;
   border-color: #36454f;
   font-weight: 600;
   transition: background-color 0.3s ease;
  }
    
  .btn-secondary:hover {
   background-color: #2a415a;
   border-color: #2a415a;
  }
    
  .api-key-box {
   font-family: 'Courier New', Courier, monospace;
   background-color: #0d1a26;
   padding: 0.75rem;
   border-radius: 6px;
   border: 1px solid #ffbf00;
   word-break: break-all;
   color: #ffffff;
  }
    
  .alert-success {
   background-color: #00704a;
   color: #ffffff;
   border-color: #004d33;
   font-weight: 500;
  }
    
  .alert-danger {
   background-color: #8b0000;
   color: #ffffff;
   border-color: #cc0000;
   font-weight: 500;
  }
 </style>
</head>
<body>

 <div class="container mt-5">

  <div class="row justify-content-center">
   <div class="col-md-8 col-lg-6 text-end mb-2">
    <a href="/admin/login" class="btn btn-sm btn-secondary">
     LOGIN SEBAGAI ADMIN üîë
    </a>
   </div>
  </div>

  <div class="row justify-content-center">
   <div class="col-md-8 col-lg-6">

    <div class="card shadow-lg">
     <div class="card-header text-center">
      <h3 class="mb-0">‚ú® Buat API Key Anda ‚ú®</h3>
     </div>

     <div class="card-body p-4">

      <% if (message) { %>
       <div class="alert alert-<%= message.type === 'success' ? 'success' : 'danger' %>" role="alert">
        <%= message.text %>
       </div>
      <% } %>

      <form action="/save-key" method="POST" id="apiKeyForm">

       <div class="row mb-3">
        <div class="col-md-6">
         <label for="first_name" class="form-label">First Name</label>
         <input type="text" class="form-control" id="first_name" name="first_name" required>
        </div>
        <div class="col-md-6">
         <label for="last_name" class="form-label">Last Name</label>
         <input type="text" class="form-control" id="last_name" name="last_name" required>
        </div>
       </div>

       <div class="mb-3">
        <label for="email" class="form-label">Email</label>
        <input type="email" class="form-control" id="email" name="email" required>
       </div>

       <hr class="my-4" style="border-color: #36454f;">

       <div class="mb-3">
        <label class="form-label">API Key Anda:</label>
        <input type="hidden" id="apiKeyInput" name="api_key">
        
        <div class="api-key-box" id="apiKeyDisplay">
         üîë Klik "Generate" untuk membuat key...
        </div>
       </div>

       <div class="d-grid gap-2 d-md-flex justify-content-between">
        <button type="button" class="btn btn-secondary" id="generateBtn">
         GENERATE KEY
        </button>

        <button type="submit" class="btn btn-primary">
         SAVE API KEY
        </button>
       </div>

      </form>

     </div>
    </div>

   </div>
   </div>

 </div>

 <script>
  document.getElementById('generateBtn').addEventListener('click', function() {
   const btn = this;
   btn.disabled = true;
   btn.textContent = 'GENERATING... ‚öôÔ∏è';

   fetch('/generate-key')
    .then(response => response.json())
    .then(data => {
     document.getElementById('apiKeyInput').value = data.apiKey;
     document.getElementById('apiKeyDisplay').textContent = data.apiKey;

     btn.disabled = false;
     btn.textContent = 'GENERATE KEY';
    })
    .catch(err => {
     console.error(err);
     document.getElementById('apiKeyDisplay').textContent = '‚ùå ERROR. COBA LAGI.';
     btn.disabled = false;
     btn.textContent = 'GENERATE KEY';
    });
  });
 </script>

</body>
</html>